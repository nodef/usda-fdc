import * as path     from "jsr:@std/path@1.0.9";
import * as csv      from "jsr:@std/csv@1.0.6";
import * as ifct2017 from "jsr:@nodef/ifct2017@1.2.1";




// Missing column aved5 [Delta-5-avenasterol] - match in ifct2017 facn5 [Cis ω-5 Fatty acids]
// Missing column b [Boron, B] - match in ifct2017 vitb [Vitamin B]
// Missing column betn [Betaine] - match in ifct2017 undefined [undefined]
// Missing column brastr [Brassicasterol] - match in ifct2017 undefined [undefined]
// Missing column camstl [Campestanol] - match in ifct2017 camt [Campesterol]
// Missing column cartbcis [cis-beta-Carotene] - match in ifct2017 cartbeq [β-Carotene equivalents]
// Missing column cartbt [trans-beta-Carotene] - match in ifct2017 cartbeq [β-Carotene equivalents]
// Missing column chlnp [Choline, from phosphotidyl choline] - match in ifct2017 undefined [undefined]
// Missing column chocaloh [25-hydroxycholecalciferol] - match in ifct2017 doh25 [25-OH-D3]
// Missing column chocsm [Carbohydrate, by summation] - match in ifct2017 choavldf [Carbohydrate]
// Missing column choln [Choline, total] - match in ifct2017 fatce [Total Fat]
// Missing column cholnf [Choline, free] - match in ifct2017 fsugar [Free Sugars]
// Missing column cholngpc [Choline, from glycerophosphocholine] - match in ifct2017 undefined [undefined]
// Missing column cholnpc [Choline, from phosphocholine] - match in ifct2017 undefined [undefined]
// Missing column cholnsm [Choline, from sphingomyelin] - match in ifct2017 undefined [undefined]
// Missing column crypxa [Cryptoxanthin, alpha] - match in ifct2017 crypxb [β-Cryptoxanthin]
// Missing column cyste [Cysteine] - match in ifct2017 cys [Cysteine]
// Missing column ddzein [Daidzein] - match in ifct2017 daidzn [Daidzein]
// Missing column egt [Ergothioneine] - match in ifct2017 undefined [undefined]
// Missing column enercawg [Energy (Atwater General Factors)] - match in ifct2017 enerc [Energy]
// Missing column enercaws [Energy (Atwater Specific Factors)] - match in ifct2017 enerc [Energy]
// Missing column erg5d7dienol [Ergosta-5,7-dienol] - match in ifct2017 facn5 [Cis ω-5 Fatty acids]
// Missing column erg7d22dienol [Ergosta-7,22-dienol] - match in ifct2017 facn7 [Cis ω-7 Fatty acids]
// Missing column erg7enol [Ergosta-7-enol] - match in ifct2017 facn7 [Cis ω-7 Fatty acids]
// Missing column ergstr [Ergosterol] - match in ifct2017 undefined [undefined]
// Missing column f12d1 [MUFA 12:1] - match in ifct2017 f14d1cn5 [Myristoleic acid (C14:1)]
// Missing column f14d1c [MUFA 14:1 c] - match in ifct2017 f14d1cn5 [Myristoleic acid (C14:1)]
// Missing column f14d1t [TFA 14:1 t] - match in ifct2017 f14d1cn5 [Myristoleic acid (C14:1)]
// Missing column f15d1 [MUFA 15:1] - match in ifct2017 f14d1cn5 [Myristoleic acid (C14:1)]
// Missing column f16d1 [MUFA 16:1 c] - match in ifct2017 f16d1cn7 [Palmitoleic acid (C16:1)]
// Missing column f16d1t [TFA 16:1 t] - match in ifct2017 f16d1cn7 [Palmitoleic acid (C16:1)]
// Missing column f17d0 [SFA 17:0] - match in ifct2017 fasat [Saturated Fatty acids]
// Missing column f17d1 [MUFA 17:1] - match in ifct2017 f14d1cn5 [Myristoleic acid (C14:1)]
// Missing column f17d1c [MUFA 17:1 c] - match in ifct2017 f14d1cn5 [Myristoleic acid (C14:1)]
// Missing column f18d1 [MUFA 18:1] - match in ifct2017 f18d1cn9 [Oleic acid (C18:1n9)]
// Missing column f18d1c [MUFA 18:1 c] - match in ifct2017 f18d1cn9 [Oleic acid (C18:1n9)]
// Missing column f18d1t [TFA 18:1 t] - match in ifct2017 f18d1tn9 [Elaidic acid (C18:1n9t)]
// Missing column f18d2 [PUFA 18:2] - match in ifct2017 f18d2cn6 [Linoleic acid (C18:2n6)]
// Missing column f18d2c [PUFA 18:2 c] - match in ifct2017 f18d2cn6 [Linoleic acid (C18:2n6)]
// Missing column f18d2cla [PUFA 18:2 CLAs] - match in ifct2017 f18d2cn6 [Linoleic acid (C18:2n6)]
// Missing column f18d2cn3 [PUFA 18:3 n-6 c,c,c] - match in ifct2017 f18d2cn6 [Linoleic acid (C18:2n6)]
// Missing column f18d2t [TFA 18:2 t not further defined] - match in ifct2017 f18d1tn9 [Elaidic acid (C18:1n9t)]
// Missing column f18d3 [PUFA 18:3i] - match in ifct2017 fapu [Polyunsaturated Fatty acids]
// Missing column f18d3c [PUFA 18:3 c] - match in ifct2017 f18d3n3 [α-Linolenic acid (C18:3n3)]
// Missing column f18d3cn3 [PUFA 18:3 n-3 c,c,c (ALA)] - match in ifct2017 f18d3n3 [α-Linolenic acid (C18:3n3)]
// Missing column f18d3t [TFA 18:3 t] - match in ifct2017 f18d3n3 [α-Linolenic acid (C18:3n3)]
// Missing column f18d4 [PUFA 18:4] - match in ifct2017 fapu [Polyunsaturated Fatty acids]
// Missing column f20d1 [MUFA 20:1] - match in ifct2017 f20d1cn9 [Eicosenoic acid (C20:1n9)]
// Missing column f20d1c [MUFA 20:1 c] - match in ifct2017 f20d1cn9 [Eicosenoic acid (C20:1n9)]
// Missing column f20d1t [TFA 20:1 t] - match in ifct2017 f18d1tn9 [Elaidic acid (C18:1n9t)]
// Missing column f20d2 [PUFA 20:2 c] - match in ifct2017 f20d2n6 [Eicosadienoic acid (C20:2)]
// Missing column f20d2cn6 [PUFA 20:2 n-6 c,c] - match in ifct2017 f20d2n6 [Eicosadienoic acid (C20:2)]
// Missing column f20d3 [PUFA 20:3 n-3] - match in ifct2017 f20d5n3 [Eicosapentaenoic acid (C20:5n3)]
// Missing column f20d3c [PUFA 20:3 c] - match in ifct2017 f20d5n3 [Eicosapentaenoic acid (C20:5n3)]
// Missing column f20d3n9 [PUFA 20:3 n-9] - match in ifct2017 f20d1cn9 [Eicosenoic acid (C20:1n9)]
// Missing column f20d4 [PUFA 20:4] - match in ifct2017 f20d4n6 [Arachidonic acid (C20:4n6)]
// Missing column f20d4c [PUFA 20:4c] - match in ifct2017 fapu [Polyunsaturated Fatty acids]
// Missing column f20d5 [PUFA 20:5c] - match in ifct2017 fapu [Polyunsaturated Fatty acids]
// Missing column f21d0 [SFA 21:0] - match in ifct2017 fasat [Saturated Fatty acids]
// Missing column f22d1 [MUFA 22:1 c] - match in ifct2017 f22d1cn9 [Erucic acid (C22:1n9)]
// Missing column f22d1cn11 [MUFA 22:1 n-11] - match in ifct2017 f22d1cn9 [Erucic acid (C22:1n9)]
// Missing column f22d1n9 [MUFA 22:1 n-9] - match in ifct2017 f22d1cn9 [Erucic acid (C22:1n9)]
// Missing column f22d1tn9 [TFA 22:1 t] - match in ifct2017 f18d1tn9 [Elaidic acid (C18:1n9t)]
// Missing column f22d2 [PUFA 22:2] - match in ifct2017 f22d2n6 [Docosadienoic acid (C22:2)]
// Missing column f22d3 [PUFA 22:3] - match in ifct2017 f22d5n3 [Docosapentaenoic acid (C22:5n3)]
// Missing column f22d4 [PUFA 22:4] - match in ifct2017 fapu [Polyunsaturated Fatty acids]
// Missing column f22d5 [PUFA 22:5 c] - match in ifct2017 f22d5n3 [Docosapentaenoic acid (C22:5n3)]
// Missing column f22d6 [PUFA 22:6 c] - match in ifct2017 f22d2n6 [Docosadienoic acid (C22:2)]
// Missing column f23d0 [SFA 23:0] - match in ifct2017 fasat [Saturated Fatty acids]
// Missing column f24d1 [MUFA 24:1 c] - match in ifct2017 f24d1cn9 [Nervonic acid (C24:1n9)]
// Missing column f5d0 [SFA 5:0] - match in ifct2017 facn5 [Cis ω-5 Fatty acids]
// Missing column f7d0 [SFA 7:0] - match in ifct2017 facn7 [Cis ω-7 Fatty acids]
// Missing column f9d0 [SFA 9:0] - match in ifct2017 facn9 [Cis ω-9 Fatty acids]
// Missing column fadt [Fatty acids, total trans-dienoic] - match in ifct2017 fatrn [Trans Fatty acids]
// Missing column fat [Total lipid (fat)] - match in ifct2017 fatce [Total Fat]
// Missing column fatnlea [Total fat (NLEA)] - match in ifct2017 fatce [Total Fat]
// Missing column fatrans [Fatty acids, total trans] - match in ifct2017 fatrn [Trans Fatty acids]
// Missing column fatrnm [Fatty acids, total trans-monoenoic] - match in ifct2017 fatrn [Trans Fatty acids]
// Missing column fatrnp [Fatty acids, total trans-polyenoic] - match in ifct2017 fatrn [Trans Fatty acids]
// Missing column fibtsw [Fiber, total dietary] - match in ifct2017 fibtg [Dietary Fiber]
// Missing column fol [Folate, total] - match in ifct2017 folsum [Folates (B9)]
// Missing column folhco10 [10-Formyl folic acid (10HCOFA)] - match in ifct2017 folsum [Folates (B9)]
// Missing column fthf5 [5-Formyltetrahydrofolic acid (5-HCOH4] - match in ifct2017 facn5 [Cis ω-5 Fatty acids]
// Missing column gals [Galactose] - match in ifct2017 undefined [undefined]
// Missing column glucnb [Beta-glucan] - match in ifct2017 cartbeq [β-Carotene equivalents]
// Missing column glyctn [Glycitin] - match in ifct2017 undefined [undefined]
// Missing column gnstin [Genistin] - match in ifct2017 undefined [undefined]
// Missing column gsh [Glutathione] - match in ifct2017 undefined [undefined]
// Missing column hmwdf [High Molecular Weight Dietary Fiber (HMWDF)] - match in ifct2017 fibtg [Dietary Fiber]
// Missing column hyp [Hydroxyproline] - match in ifct2017 undefined [undefined]
// Missing column id [Iodine, I] - match in ifct2017 ile [Isoleucine]
// Missing column lacs [Lactose] - match in ifct2017 lactose [Lactose]
// Missing column lmwdf [Low Molecular Weight Dietary Fiber (LMWDF)] - match in ifct2017 fibtg [Dietary Fiber]
// Missing column lycpncis [cis-Lycopene] - match in ifct2017 lycpn [Lycopene]
// Missing column lycpnt [trans-Lycopene] - match in ifct2017 lycpn [Lycopene]
// Missing column lzea [Lutein + zeaxanthin] - match in ifct2017 lutn [Lutein]
// Missing column lzeac [cis-Lutein/Zeaxanthin] - match in ifct2017 lutn [Lutein]
// Missing column mk4 [Vitamin K (Menaquinone-4)] - match in ifct2017 vitk2 [Menaquinones (K2)]
// Missing column mthf5 [5-methyl tetrahydrofolate (5-MTHF)] - match in ifct2017 facn5 [Cis ω-5 Fatty acids]
// Missing column nt [Nitrogen] - match in ifct2017 undefined [undefined]
// Missing column oxalac [Oxalic acid] - match in ifct2017 oxals [Soluble Oxalate]
// Missing column phyflu [Phytofluene] - match in ifct2017 undefined [undefined]
// Missing column phystroth [Phytosterols, other] - match in ifct2017 phystr [Phytosterols]
// Missing column phytoene [Phytoene] - match in ifct2017 undefined [undefined]
// Missing column procnt [Protein] - match in ifct2017 protcnt [Protein]
// Missing column pyrac [Pyruvic acid] - match in ifct2017 asp [Aspartic acid]
// Missing column s [Sulfur, S] - match in ifct2017 ser [Serine]
// Missing column sitstl [Beta-sitostanol] - match in ifct2017 cartbeq [β-Carotene equivalents]
// Missing column sitstr [Beta-sitosterol] - match in ifct2017 stostrb [β-Sitosterol]
// Missing column spgr [Specific Gravity] - match in ifct2017 undefined [undefined]
// Missing column stares [Resistant starch] - match in ifct2017 starch [Starch]
// Missing column stgmd [Stigmastadiene] - match in ifct2017 undefined [undefined]
// Missing column stigma7 [Delta-7-Stigmastenol] - match in ifct2017 facn7 [Cis ω-7 Fatty acids]
// Missing column sugar [Sugars, Total] - match in ifct2017 fsugar [Free Sugars]
// Missing column vitaa [Vitamin A, RAE] - match in ifct2017 vita [Vitamin A]
// Missing column vitb12 [Vitamin B-12] - match in ifct2017 vitb [Vitamin B]
// Missing column vitb6a [Vitamin B-6] - match in ifct2017 vitb6c [Total B6]
// Missing column vitd4 [Vitamin D4] - match in ifct2017 vit [Vitamins]
// Missing column vitda [Vitamin D (D2 + D3), International Units] - match in ifct2017 ergcal [Ergocalciferol (D2)]
// Missing column vitk1d [Vitamin K (Dihydrophylloquinone)] - match in ifct2017 vitk [Vitamin K]
// Missing 120/222 columns




async function main() {
  const columns = await ifct2017.loadColumns();
  const file = path.join(import.meta.dirname || "", "columns.csv");
  const data = await Deno.readTextFile(file);
  const records = csv.parse(data, {skipFirstRow: true, comment: "#"});
  let missing = 0;
  for (const r of records) {
    if (columns.has(r.code)) continue;  // There was an exact match
    const match = ifct2017.columns(r.name)[0];
    console.warn(`Missing column ${r.code} [${r.name}] - match in ifct2017 ${match?.code} [${match?.name}]`);
    missing++;
  }
  console.log(`Missing ${missing}/${records.length} columns`);
}
main();
